{% extends 'base.html' %}

{% block title %}Student Profile - MITS FLEX{% endblock %}

{% block content %}
<div class="section">
    <h2>Student Profile</h2>
    <hr />
    <form id="profileForm" method="post">
        {% csrf_token %}
        <div class="profile-grid">
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" value="{{ user.first_name }}" disabled>
            </div>
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" value="{{ user.username }}" disabled>
            </div>
            <div class="form-group">
                <label for="leetcode_user">LeetCode Username:</label>
                <input type="text" id="leetcode_user" name="leetcode_user" value="{{ user.leetcode_user }}" disabled>
            </div>
            <div class="form-group">
                <label for="year">Year:</label>
                <input type="number" id="year" name="year" value="{{ user.year }}" disabled>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <select id="section" name="section" disabled>
                    {% for section in user.SECTION_CHOICES %}
                        <option value="{{ section.0 }}" {% if section.0 == user.section %}selected{% endif %}>
                            {{ section.1 }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="mobile">Mobile:</label>
                <input type="text" id="mobile" name="mobile" value="{{ user.phone }}" disabled/>
            </div>
        </div>
        
        <div class="button-group">
            <button type="button" id="editButton">
                <i class="bi bi-pencil"></i>
                Edit
            </button>
            <button type="submit" id="saveButton" class="d-none">
                <i class="bi bi-check-lg"></i>
                Save
            </button>
            <button type="button" id="cancelButton" class="d-none">
                <i class="bi bi-x-lg"></i>
                Cancel
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_head %}
<style>
    .profile-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .form-group {
        display: flex;
        flex-direction: column;
    }

    .form-group label {
        margin-bottom: 0.5rem;
        color: #f1c40f;
        font-weight: 500;
    }

    .light-theme .form-group label {
        color: #f39c12;
    }

    .button-group {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 2rem;
    }

    .button-group button {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    #editButton {
        background-color: #f1c40f;
        color: #000;
    }

    #editButton:hover {
        background-color: #f39c12;
    }

    .light-theme #editButton {
        background-color: #f39c12;
        color: #fff;
    }

    .light-theme #editButton:hover {
        background-color: #d3a500;
    }

    #saveButton {
        background-color: #28a745;
        color: #fff;
    }

    #saveButton:hover {
        background-color: #218838;
    }

    #cancelButton {
        background-color: #6c757d;
        color: #fff;
    }

    #cancelButton:hover {
        background-color: #5a6268;
    }

    .d-none {
        display: none !important;
    }

    input:disabled,
    select:disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    @media (max-width: 768px) {
        .profile-grid {
            grid-template-columns: 1fr;
        }
        
        .button-group {
            flex-direction: column;
            align-items: center;
        }
        
        .button-group button {
            width: 200px;
            justify-content: center;
        }
    }
</style>
{% endblock %}

{% block extra_scripts %}
<script>
    const editButton = document.getElementById('editButton');
    const saveButton = document.getElementById('saveButton');
    const cancelButton = document.getElementById('cancelButton');
    const inputs = document.querySelectorAll('#profileForm input, #profileForm select');

    editButton.addEventListener('click', () => {
        inputs.forEach(input => input.disabled = false);
        editButton.classList.add('d-none');
        saveButton.classList.remove('d-none');
        cancelButton.classList.remove('d-none');
    });

    cancelButton.addEventListener('click', () => {
        inputs.forEach(input => input.disabled = true);
        editButton.classList.remove('d-none');
        saveButton.classList.add('d-none');
        cancelButton.classList.add('d-none');
        
        // Reset fields to original values
        inputs.forEach(input => input.value = input.defaultValue);
    });
</script>
{% endblock %}